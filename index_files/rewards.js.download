var BWRewards={};(function(){"use strict";var h="/restapi/rewards/products",p="/restapi/rewards/spend",w="/restapi/rewards/profile",b="/restapi/rewards/statement",k="/restapi/rewards/vendors",d="/restapi/rewards/missingpoints",g="/restapi/rewards/prizes",nt="/restapi/rewards/forgottenpassword",tt="/restapi/rewards/linkaccounts",it="/restapi/rewards/join",rt="/restapi/rewards/promotions",i={"false":null,"true":null},u={"false":null,"true":null},o={"false":[],"true":[]},c=function(n){while(o[n].length)o[n].pop()()},r=null,f=!1,s=[],l=function(){while(s.length)s.pop()()},t=function(n){return function(t){n!==undefined&&n(t)}},n=function(n,t){return function(n,i,r){t!==undefined&&t(n,i,r)}},e=function(n){if(typeof n=="string")return n;if(n.responseJSON&&n.responseJSON.ResponseStatus&&n.responseJSON.ResponseStatus.Message)return n.responseJSON.ResponseStatus.Message;if(n.responseText)try{var t=JSON.parse(n.responseText);if(t.ResponseStatus&&t.ResponseStatus.Message)return t.ResponseStatus.Message;if(t.Message)return t.Message}catch(i){}return"A problem has occurred with this request"},a,v,y;BWRewards.GetErrorMessage=function(n){return e(n)};BWRewards.JoinProfile=function(){this.Title=null;this.FirstName=null;this.MiddleName=null;this.LastName=null;this.Email=null;this.Password=null;this.AddressType=null;this.HouseNameNumber=null;this.Street=null;this.Locality=null;this.TownCity=null;this.County=null;this.Postcode=null;this.Company=null;this.JobTitle=null;this.Telephone=null;this.DateOfBirth=null;this.ContactPreferences=null;this.EarningPreference=null;this.AirmilesVendor=null;this.AirmilesNumber=null;this.Confirmed18=null};BWRewards.JoinProfile.prototype.toString=function(){return"BWRewards.JoinProfile"};BWRewards.JoinRewards=function(i,r,u){if(!(i instanceof BWRewards.JoinProfile)){n("JoinRewards - data is not a JoinProfile",u)(null,null,"Data is not a JoinProfile");return}$.ajax({url:it,type:"POST",accept:"application/json",data:JSON.stringify(i),dataType:"json",contentType:"application/json; charset=utf-8",success:t(r),error:n("JoinRewards",u)})};BWRewards.GetProducts=function(i,r){$.ajax({url:h,type:"GET",accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:t(i),error:n("GetRewardsProducts",r)})};a=function(n){var u,s,r,f,t,h;n.GroupedVariants=[];n.Variants=n.Variants.sort(function(n,t){return n.Points-t.Points});$(n.Variants).each(function(t,i){var r=$.grep(n.GroupedVariants,function(n){return n.Tag===i.Tag});r.length===0?(r={Tag:i.Tag,Products:[]},n.GroupedVariants.push(r)):r=r[0];r.Products.push(i)});var c=function(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},o=function(n){return n},i=new kendo.observable({});for(i=new kendo.observable({PointsFrom:0,PointsTo:0,Region:"00000000-0000-0000-0000-000000000000",Month:(new Date).getMonth()+1,Hotels:[],IsLoading:!1,SearchButtonClass:function(){return this.get("IsLoading")?"button right is_loading":"button right"},PointsText:function(n){return c(n.GCCICategory)},AddressSummary:function(n){return n.Address===null?null:[[n.Address.Street,n.Address.City].filter(o).join(", "),n.Address.Zip].filter(o).join(" | ")},SearchHotels:function(n){var u=n.data,t={},f=document.getElementById("freeHotelRange").noUiSlider.get(),r;return t.PointsFrom=parseInt(f[0],10),t.PointsTo=parseInt(f[1],10),r=i.get("selectedPoint"),r!==null&&r.id&&(t.Property=r.id),t.Region=n.data.get("Region"),t.Month=n.data.get("Month"),n.data.set("Hotels",[]),n.data.set("IsLoading",!0),$.ajax({url:"/restapi/rewards/freehotels",type:"GET",dataType:"json",accept:"application/json",contentType:"application/json; charset=utf-8",data:t,success:function(n){u.set("Hotels",n)},complete:function(){u.set("IsLoading",!1)}}),!1},selectedPoint:null,onSelect:function(n){var t=n.sender.dataItem(n.item.index());this.set("selectedPoint",t);this.set("Region",null);$("[data-region]").next(".customSelect").find(".customSelectInner").text("Select region");$("html").is(".k-ie11, .k-ie10, .k-ie9")||$('[data-template="variant_template_search"] .clear-selection').show()},points:new kendo.data.DataSource({serverFiltering:!0,transport:{cache:!0,parameterMap:function(n){return{term:n.filter.filters[0].value,international:!1,hotelsOnly:!0}},read:{url:"/restapi/autocomplete/poi/",contentType:"application/json charset=utf-8",serverPaging:!0,type:"GET",dataType:"json"}}}),regionChanged:function(){i.set("selectedPoint",null)},onClose:function(){isMobile&&setTimeout(function(){$("input.search_keyword").focus().blur()},50)}}),u=[],s=new Date,r=0;r<12;r++)f=s.addMonth(r),u.push({Item1:parseInt(f.getMonth()+1,10),Item2:f.format("MMMM yyyy")});return t=new kendo.observable,h=wNumb({thousand:",",decimals:0}),t=new kendo.observable({Product:n,Loading:!1,FreeHotelSearch:i,Regions:[],Months:u,MinPointsText:function(n){if(n.get("MinPoints")){var t=parseInt(n.get("MinPoints"),10);return String.format("From {0} points",h.to(t))}},RelatedSubtotal:function(n){if(n===undefined)return 0;var t=parseInt(n.get("Quantity"),10);return Math.max(n.get("Points"),n.get("Points")*t)},Subtotal:function(n){if(n===undefined)return 0;var t=parseInt(n.get("Quantity"),10);return n.get("Points")*t},Total:function(){var n=this.get("Product.Variants"),t=$(n).map(function(n,t){return t.Points*parseInt(t.Quantity,10)});return t.toArray().reduce(function(n,t){return n+t})},SpendStage:function(){return t.get("Mode")=="SpendPointsConfirm"||t.get("Mode")=="SpendingPoints"||t.get("Mode")=="SpendPointsSuccess"||t.get("Mode")=="SpendPointsFailure"},GoBack:function(){this.set("Mode","");this.set("ErrorMessage",null)},BuyText:function(){return n.IsNSPCC===!0?"Donate for":"Buy for"},IsNSPCC:function(){return n.IsNSPCC===!0},DeliveryDetails:null,DeliveryEditMode:!1,UpdateDeliveryDetails:function(){this.set("DeliveryEditMode",!0)},DeliveryDetailsAddressSummary:function(){return[this.get("DeliveryDetails.Line1"),this.get("DeliveryDetails.Line2"),this.get("DeliveryDetails.City"),this.get("DeliveryDetails.Postcode")].filter(function(n){return n}).join(", ")},DeliveryNameSummary:function(){return[this.get("DeliveryDetails.Title"),this.get("DeliveryDetails.FirstName"),this.get("DeliveryDetails.LastName")].filter(function(n){return n}).join(" ")},SaveDeliveryDetails:function(){this.set("DeliveryEditMode",!1)},VirtualDeliveryEdit:function(){return this.get("Product.VirtualDelivery")===!0&&this.get("DeliveryEditMode")===!0},PhysicalDeliveryEdit:function(){return this.get("Product.VirtualDelivery")!==!0&&this.get("DeliveryEditMode")===!0},VirtualDelivery:function(){return this.get("Product.VirtualDelivery")===!0&&this.get("DeliveryEditMode")!==!0},PhysicalDelivery:function(){return this.get("Product.VirtualDelivery")!==!0&&this.get("DeliveryEditMode")!==!0},Mode:"",ProductTemplateTabular:function(){return this.get("Product.Template")==="tabular"},ProductTemplateRelated:function(){return this.get("Product.Template")==="related"},ProductTemplateSearch:function(){return this.get("Product.Template")==="search"},ProductTemplateVariant:function(){return this.get("Product.Template")==="variant"},SpendPointsConfirm:function(){return t.get("Mode")==="SpendPointsConfirm"},SpendingPoints:function(){return t.get("Mode")==="SpendingPoints"},SpendPointsSuccess:function(){return t.get("Mode")==="SpendPointsSuccess"},SpendPointsFailure:function(){return t.get("Mode")==="SpendPointsFailure"},ErrorMessage:null,ConfirmSpend:function(n){var t=this.SpendRequest(n);if(t.length==0){BestWestern.ShowMessage("Please choose a Best Western Reward to spend your points on");return}this.set("Mode","SpendPointsConfirm")},SpendRequest:function(n){var i=new kendo.observableHierarchy([]);return t.get("Product.Template")==="related"?t.get("Product.Quantity")>0&&i.push(kendo.observable({Title:n.data.Title,AwardCode:n.data.VariantID,Quantity:n.data.Quantity,Points:n.data.Potins,Subtotal:n.data.Quantity*n.data.Points})):t.get("Product.Template")==="tabular"&&(i=t.get("Product.Variants").filter(function(n){return n.Quantity>0}).map(function(n){return new kendo.observable({Title:n.Title,Quantity:parseInt(n.Quantity,10),AwardCode:n.VariantID,Points:n.Points,Subtotal:n.Quantity*n.Points})})),i},SpendPoints:function(){var n=this,i=this.get("SpendRequest")(),t;if(i.length==0){BestWestern.ShowMessage("Please choose a Best Western Reward to spend your points on");return}t={Items:i,Email:this.get("DeliveryDetails.Email"),Title:this.get("DeliveryDetails.Title"),FirstName:this.get("DeliveryDetails.FirstName"),LastName:this.get("DeliveryDetails.LastName"),Line1:this.get("DeliveryDetails.Line1"),Line2:this.get("DeliveryDetails.Line2"),City:this.get("DeliveryDetails.City"),Postcode:this.get("DeliveryDetails.Postcode")};t.Items.length>0&&(this.set("Mode","SpendingPoints"),BWRewards.SpendPoints(t,function(){n.set("Mode","SpendPointsSuccess")},function(t){n.set("Mode","SpendPointsFailure");n.set("ErrorMessage",e(t))}))}}),t.Product.Template!=="search"?BWRewards.GetProfile(function(n){n!==null&&(t.set("DeliveryDetails",n.Profile.Address),t.set("DeliveryDetails.Email",n.Profile.Email),t.set("DeliveryDetails.Title",n.Profile.Title),t.set("DeliveryDetails.FirstName",n.Profile.FirstName),t.set("DeliveryDetails.LastName",n.Profile.LastName))}):BWRewards.GetRegions(function(n){n!==null&&n.unshift({Item1:"00000000-0000-0000-0000-000000000000",Item2:"Select region"});t.set("FreeHotelSearch.Regions",n)}),t};BWRewards.GetProductWithVariant=function(i,r,u){$.ajax({url:h,type:"GET",accept:"application/json",dataType:"json",data:i,contentType:"application/json; charset=utf-8",success:function(n){var i=a(n);t(r)(i)},error:n("GetRewardsProductWithVariants",u)})};BWRewards.GetStatement=function(t,i,r,u,f){var e=$("#statement_generator");e.length>0&&$("html, body").animate({scrollTop:e.offset().top+e.height()});$.ajax({url:b,type:"GET",accept:"application/json",dataType:"json",data:{DateFrom:t,DateTo:i},contentType:"application/json; charset=utf-8",success:function(n){for(var t=kendo.observable({Binding:!1,StatementVisible:function(){return this.get("Binding")!==!0},DateFrom:n.DateFrom,DateTo:n.DateTo,Items:n.Items,DateFromFormatted:function(){return this.get("DateFrom").toDateObject().format("dd MMMM yyyy")},DateToFormatted:function(){return this.get("DateTo").toDateObject().format("dd MMMM yyyy")},PrintStatement:function(){window.print()},PrintStatementClick:function(n){var t=n.currentTarget.getAttribute("data-width"),i=n.currentTarget.getAttribute("data-height"),r=n.currentTarget.href,u=screen.width/2-t/2,f=screen.height/2-i/2;window.open(r,"Print Statement","width="+t+",height="+i+",left="+u+",top="+f+",toolbar=0,menubar=0");n.preventDefault()},PrintStatementUrl:function(){return this.get("DateFrom")&&this.get("DateTo")?String.format("/my-best-western/rewards/print-statement/?datefrom={0}&dateto={1}",this.get("DateFrom"),this.get("DateTo")):"javascript:;"},PrintView:r}),i=0;i<t.Items.length;i++)t.Items[i].CheckInDate=kendo.parseDate(t.Items[i].CheckIn,"yyyy-MM-dd"),t.Items[i].CheckOutDate=kendo.parseDate(t.Items[i].CheckOut,"yyyy-MM-dd"),t.Items[i].TransactionDate=kendo.parseDate(t.Items[i].Transaction,"yyyy-MM-dd");u!==undefined&&u(t)},error:n("GetRewardsStatement",f)})};v=function(n){return kendo.observable({Profile:n,Binding:!1,BindingError:!1,ProfileVisible:!0,CongratulationsMessage:function(){return this.get("Profile.Points")===0?String.format("{0}, build up your points balance today",this.get("Profile.FirstName")):String.format("Congratulations {0}, you have collected",this.get("Profile.FirstName"))},FormattedMemberId:function(){var n=this.get("Profile.MemberId");return[n.substring(0,6),n.substring(6,7),n.substring(7,15),n.substring(15,16)].join(" ")},FullName:function(){return[this.get("Profile.FirstName"),this.get("Profile.LastName")].join(" ")},ShowNightsNextTier:function(){var n=this.get("Profile.TierLevel").toLowerCase();return n&&n!=="diamond select"},NextTierName:function(){if(this.get("Profile.NextTierLevel")===null)return null;var n=this.get("Profile.NextTierLevel");return n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},NextTierNights:function(){return String.format("{0} Nights",this.get("Profile.NextTier"))},NextTierPoints:function(){var n=wNumb({thousand:",",decimals:0});return String.format("{0} Points",n.to(this.get("Profile.PointsToNextTier")))},NextTierStays:function(){var n=wNumb({thousand:",",decimals:0});return String.format("{0} Stays",n.to(this.get("Profile.StaysToNextTier")))},RewardsCardClass:function(){return["rewards_card",this.get("Profile.TierLevel").toLowerCase().split(" ").join("-")].join(" ")},ErrorMessage:null})};BWRewards.GetProfile=function(i,u){f?s.push(function(){BWRewards.GetProfile(i,u)}):r===null?(f=!0,$.ajax({url:w,type:"GET",accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){r=v(n);f=!1;l();t(i)(r)},error:function(t,i,e){var o=t.responseJSON&&t.responseJSON.ResponseStatus?t.responseJSON.ResponseStatus.Message:null;r=kendo.observable({Binding:!1,BindingError:!0,ErrorMessage:o});f=!1;l();n("GetRewardsProfile",u)(t,i,e)}})):t(i)(r)};BWRewards.BookingItem=function(){this.CardPresented=!1;this.CheckInDate=null;this.CheckOutDate=null;this.City=null;this.Comments=null;this.ConfirmationNumber=null;this.Country=null;this.HotelName=null;this.NightlyRoomRate=0;this.State=null;this.v=(new Date).getTime()};BWRewards.GetRegions=function(i,r){$.ajax({url:"/restapi/rewards/regions",type:"GET",accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:t(i),error:n("GetRegions",r)})};BWRewards.GetVendors=function(i,r){$.ajax({url:k,type:"GET",accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:t(i),error:n("Vendors",r)})};BWRewards.SpendPoints=function(i,r,u){var f=i.Items.map(function(n){return n.Subtotal}).reduce(function(n,t){return n+t}),e=function(){$.ajax({url:p,type:"POST",accept:"application/json",data:JSON.stringify(i),dataType:"json",contentType:"application/json; charset=utf-8",success:t(r),error:n("SpendPoints",u)})};BWRewards.Prizes(!1,function(n){if(n.CurrentPoints!==undefined&&n.CurrentPoints>=f)e();else if(n.CurrentPoints!==undefined){var t=String.format("You seem to be {0} points short!",f-n.CurrentPoints);u!==undefined&&u(t)}else u(n)},function(n){BestWestern.ShowMessage(n)})};BWRewards.LinkAccounts=function(i,r,u,f){$.ajax({url:tt,type:"POST",accept:"application/json",data:JSON.stringify({CardNumber:i,Password:r}),dataType:"json",contentType:"application/json; charset=utf-8",success:t(u),error:n("LinkAccounts",f)})};BWRewards.ForgottenPassword=function(i,r,u){$.ajax({url:nt,type:"POST",accept:"application/json",data:JSON.stringify({CardNumber:i}),dataType:"json",contentType:"application/json; charset=utf-8",success:t(r),error:n("ForgottenPassword",u)})};BWRewards.LinkAccountsViewModel=function(){return{LinkAccountsView:!0,ForgottenPasswordView:!1,ErrorView:!1,ErrorMessage:null,CardNumber:null,Password:null,SuccessMessage:null,IsLoading:!1,SwitchViewForgotPassword:function(){this.set("IsLoading",!1);this.set("ForgottenPasswordView",!0);this.set("LinkAccountsView",!1);this.set("ErrorView",!1)},SwitchViewLinkAccount:function(){this.set("IsLoading",!1);this.set("ForgottenPasswordView",!1);this.set("LinkAccountsView",!0);this.set("ErrorView",!1)},SwitchViewError:function(n,t){this.set("IsLoading",!1);this.set("ErrorView",!0);this.set("ForgottenPasswordView",!1);this.set("LinkAccountsView",!1);this.set("ErrorMessage",t);this.set("Password",null)},LinkAccountsClass:function(){var n="button inline_block mr15";return this.get("IsLoading")&&(n=n+" is_loading disabled"),n},LinkAccountsClick:function(n){var t=this;this.set("IsLoading",!0);BWRewards.LinkAccounts(this.get("CardNumber"),this.get("Password"),function(){window.location="/my-best-western/rewards-authenticating"},function(i){t.SwitchViewError(n,e(i))})},ForgottenPasswordClick:function(n){var t=this;this.set("IsLoading",!0);BWRewards.ForgottenPassword(this.get("CardNumber"),function(i){i?(t.set("IsLoading",!1),t.set("SuccessMessage","Your password has been emailed to you - please <strong>copy and paste it from the email<\/strong> into the password box.")):t.SwitchViewError(n,"Password reset failed.")},function(i){t.SwitchViewError(n,e(i))})}}};BWRewards.RequestNewCard=function(i,r){$.ajax({url:requestNewCardServiceUrl,type:"POST",accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:t(i),error:n("RequestNewCard",r)})};y=function(n){var t,i;if(n)return t=n.Items,i={CanAfford:function(){return this.get("Points")<=this.parent().parent().get("CurrentPoints")},CantAfford:function(){return this.get("Points")>this.parent().parent().get("CurrentPoints")}},$.each(t,function(n,t){$.extend(t,i)}),kendo.observable({CurrentPoints:n.CurrentPoints,CurrentPointsText:String.format("{0} Rewards Points",n.CurrentPoints),RewardsUser:n.RewardsUser,RewardsUserVisible:function(){return!this.BindingError&&this.RewardsUser!==null},NonRewardsUserVisible:function(){return!this.BindingError&&this.RewardsUser===null},TierLevel:n.TierLevel,RewardsCardClassHeader:function(){return["my_act_pnl_rewards_header",this.get("TierLevel").toLowerCase()].join(" ")},TierLevelText:String.format("{0} Member",n.TierLevel),Items:n.Items,Binding:!1,BindingError:!1})};BWRewards.Prizes=function(r,f,e){u[r]?o[r].push(function(){BWRewards.Prizes(r,f,e)}):i[r]===null?(u[r]=!0,$.ajax({url:g,type:"GET",data:{ShowCurrentlyAvailableProducts:r},accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){i[r]=y(n);u[r]=!1;c(r);t(f)(i[r])},error:function(t){var f=t.responseJSON&&t.responseJSON.ResponseStatus?t.responseJSON.ResponseStatus.Message:null;i[r]=kendo.observable({Binding:!1,BindingError:!0,ErrorMessage:f,Items:[],RewardsUserVisible:!1,NonRewardsUserVisible:!1});u[r]=!1;c(r);$("#ha_rewards").removeClass("has_overlay");$("#ha_rewards").hide();n("Prizes",e)(t,i[r])}})):i[r]===null||i[r].BindingError?n("Prizes",e)(null,i[r]):t(f)(i[r])};BWRewards.SendMissingPoints=function(i,r,u){$.ajax({url:d,type:"POST",accept:"application/json",dataType:"json",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",success:t(r),error:n("SendMissingPoints",u)})};BWRewards.RegisterForPromotion=function(i,r,u,f,e,o){$.ajax({url:rt,type:"POST",data:JSON.stringify({PromotionCode:i,PromotionId:r,RewardsId:u,VendorCode:f}),accept:"application/json",dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){t(e)(n)},error:function(t,i,r){n("GetPromotions",o)(t,i,r)}})}})();
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI");Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts.initializeBase(this,[n]);this._templateContent=null;this._bindDataSourceDelegate=null;this._detailsPageUrl=null};Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts.callBaseMethod(this,"initialize");this._bindDataSourceDelegate=Function.createDelegate(this,this.bindDataSource);this.loadData()},dispose:function(){this._bindDataSourceDelegate&&delete this._bindDataSourceDelegate;Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts.callBaseMethod(this,"dispose")},SfStatusKey:"sf-lc-status",SfContentActionKey:"sf-content-action",SfAuthKey:"sf-auth",loadData:function(){BWRewards.GetProducts(this._bindDataSourceDelegate)},bindDataSource:function(n){var t=this,i=this.get_detailsPageUrl(),r=new kendo.data.DataSource({schema:{model:{id:"ProductId"},parse:function(n){return $.each(n,function(n,t){t.Url=[i,t.Url].join("/");t.Index=n}),n}},data:n});$("#rewards_products").kendoListView({dataSource:r,template:kendo.template(t.get_templateContent())});$(".loading",this.get_element()).remove()},get_templateContent:function(){return this._templateContent},set_templateContent:function(n){this._templateContent=n},get_detailsPageUrl:function(){return this._detailsPageUrl},set_detailsPageUrl:function(n){this._detailsPageUrl=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProducts",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI");Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants.initializeBase(this,[n]);this._templateContent=null;this._bindDataSourceDelegate=null;this._clearSelection=null;this._dataSource=null};Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants.callBaseMethod(this,"initialize");this._bindDataSourceDelegate=Function.createDelegate(this,this.bindDataSource);this.loadData()},dispose:function(){this._bindDataSourceDelegate&&delete this._bindDataSourceDelegate;Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants.callBaseMethod(this,"dispose")},SfStatusKey:"sf-lc-status",SfContentActionKey:"sf-content-action",SfAuthKey:"sf-auth",loadData:function(){var n=window.location.pathname.split("/"),t=n[n.length-1],i={ProductUrl:decodeURI(t),SfStatus:urlParams[this.SfStatusKey],SfContentAction:urlParams[this.SfContentActionKey],SfAuth:urlParams[this.SfAuthKey]};BWRewards.GetProductWithVariant(i,this._bindDataSourceDelegate)},bindDataSource:function(n){var t,i;this.set_dataSource(n);kendo.bind(this.get_element(),n);t=document.getElementById("freeHotelRange");t&&(sliderFormat=wNumb({thousand:",",decimals:0}),noUiSlider.create(t,{start:[8e3,36e3],range:{min:[8e3],max:[36e3]},step:4e3,pips:{mode:"steps",density:1,format:sliderFormat}}));i=$(".clear-selection",this.get_element());i.length>0&&(this.set_clearSelection(i[0]),this._clearSearchDelegate=Function.createDelegate(this,this.clearSearch),$addHandler(this.get_clearSelection(),"click",this._clearSearchDelegate));BestWestern.StyleSelects(250);$("input.search_keyword").on("focus",function(){if($("input.search_keyword").length>0&&isMobile){$("#autocomplete-position").remove();var n=$("input.search_keyword").offset().top+$("input.search_keyword").outerHeight();$("head").append('<style id="autocomplete-position">.k-animation-container { top: '+n+"px !important; }<\/style>")}})},clearSearch:function(){var n=this.get_dataSource();n.FreeHotelSearch.selectedPoint=null;$('[data-role="autocomplete"]',this.get_element()).data("kendoAutoComplete").value("");$(this.get_clearSelection()).hide()},get_templateContent:function(){return this._templateContent},set_templateContent:function(n){this._templateContent=n},get_clearSelection:function(){return this._clearSelection},set_clearSelection:function(n){this._clearSelection=n},get_dataSource:function(){return this._dataSource},set_dataSource:function(n){this._dataSource=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.RewardsProductVariants",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile.callBaseMethod(this,"initialize");this._bindDataSourceDelegate=Function.createDelegate(this,this.bindDataSource);this._bindDataSourceErrorDelegate=Function.createDelegate(this,this.bindDataSourceError);this.loadData()},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile.callBaseMethod(this,"dispose")},loadData:function(){var n=this;this.setBinding();BestWestern.AddWindowLoad(function(){BWRewards.GetProfile(n._bindDataSourceDelegate,n._bindDataSourceErrorDelegate)},1)},setBinding:function(){kendo.bind(this.get_element(),kendo.observable({Binding:!0,ProfileVisible:!1}))},bindDataSourceError:function(){kendo.bind(this.get_element(),kendo.observable({Binding:!1,BindingError:!0,ProfileVisible:!1}))},bindDataSource:function(n){kendo.bind(this.get_element(),n)}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsProfile",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement.initializeBase(this,[n]);this._viewModel=null;this._printView=null;this._bindDataSourceDelegate=null};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement.callBaseMethod(this,"initialize");kendo.data.binders.date=kendo.data.Binder.extend({init:function(n,t,i){kendo.data.Binder.fn.init.call(this,n,t,i);this.dateformat=$(n).data("dateformat")},refresh:function(){var n=this.bindings.date.get(),t;n&&(t=new Date(n),$(this.element).text(kendo.toString(t,this.dateformat)))}});var n=urlParams.datefrom,t=urlParams.dateto;n!==undefined&&t!==undefined&&(this._bindDataSourceDelegate=Function.createDelegate(this,this.bindDataSource),this.setBinding(),BWRewards.GetStatement(n,t,this.get_printView(),this._bindDataSourceDelegate))},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement.callBaseMethod(this,"dispose")},bindDataSource:function(n){this.set_viewModel(n);kendo.bind(this.get_element(),this.get_viewModel())},setBinding:function(){this.get_viewModel()===null?(this.set_viewModel(kendo.observable({Binding:!0,Items:[]})),this.bindDataSource(this.get_viewModel())):this.get_viewModel().set("Binding",!0)},get_viewModel:function(){return this._viewModel},set_viewModel:function(n){this._viewModel=n},get_printView:function(){return this._printView},set_printView:function(n){this._printView=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter=function(n){this._bindDataSourceDelegate=null;this._loadStatementDelegate=null;this._statementDaysChangedDelegate=null;this._dateChangedDelegate=null;this._statementDays=null;this._dateFrom=null;this._dateFromPicker=null;this._dateTo=null;this._dateToPicker=null;this._generateStatement=null;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter.prototype={initialize:function(){var n,t,i;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter.callBaseMethod(this,"initialize");this._bindDataSourceDelegate=Function.createDelegate(this,this.bindDataSource);this._loadStatementDelegate=Function.createDelegate(this,this.loadStatement);this._statementDaysChangedDelegate=Function.createDelegate(this,this.statementDaysChanged);this._dateChangedDelegate=Function.createDelegate(this,this.dateChanged);n={format:"dd M yyyy",autoclose:!0,todayHighlight:!0};t=$(this.get_dateFrom()).bsDatepicker(n);t.on("change",this._dateChangedDelegate);this.set_dateFromPicker(t.data("datepicker"));i=$(this.get_dateTo()).bsDatepicker(n);i.on("change",this._dateChangedDelegate);this.set_dateToPicker(i.data("datepicker"));$addHandler(this.get_generateStatement(),"click",this._loadStatementDelegate);$addHandler(this.get_statementDays(),"change",this._statementDaysChangedDelegate)},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter.callBaseMethod(this,"dispose")},lastOption:null,statementDaysChanged:function(){this.lastOption="simple"},dateChanged:function(){this.lastOption="dates"},loadStatement:function(){var n,t,i;if(this.lastOption!==null){if($(".sfFieldWrp.form_error",this.get_element()).removeClass("form_error"),n="",t="",this.lastOption==="simple")i=parseInt($(this.get_statementDays()).val(),10),t=Date.Today().format("yyyy-MM-dd"),n=new Date(Date.Today().getTime()-i*864e5).format("yyyy-MM-dd");else if(this.lastOption==="dates"){if(this.get_dateFromPicker().getDates().length===0&&$(this.get_dateFrom()).parent(".sfFieldWrp").addClass("form_error"),this.get_dateToPicker().getDates().length===0&&$(this.get_dateTo()).parent(".sfFieldWrp").addClass("form_error"),this.get_dateToPicker().getDates().length+this.get_dateFromPicker().getDates().length<2)return;n=this.get_dateFromPicker().getDates()[0].format("yyyy-MM-dd");t=this.get_dateToPicker().getDates()[0].format("yyyy-MM-dd")}else return;this.set_statementControl(BestWestern.GetControl(Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatement));this.get_statementControl().setBinding();BWRewards.GetStatement(n,t,!1,this._bindDataSourceDelegate)}},bindDataSource:function(n){this.get_statementControl().bindDataSource(n)},get_statementDays:function(){return this._statementDays},set_statementDays:function(n){this._statementDays=n},get_dateFrom:function(){return this._dateFrom},set_dateFrom:function(n){this._dateFrom=n},get_dateTo:function(){return this._dateTo},set_dateTo:function(n){this._dateTo=n},get_generateStatement:function(){return this._generateStatement},set_generateStatement:function(n){this._generateStatement=n},get_dateFromPicker:function(){return this._dateFromPicker},set_dateFromPicker:function(n){this._dateFromPicker=n},get_dateToPicker:function(){return this._dateToPicker},set_dateToPicker:function(n){this._dateToPicker=n},get_statementControl:function(){return this._statementControl},set_statementControl:function(n){this._statementControl=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsStatementFilter",Sys.UI.Control);
function GetMinDate(){return kendo.toString(kendo.date.addDays(new Date,-186),"yyyy-MM-dd")}function GetMaxDate(n){return kendo.toString(kendo.date.addDays(new Date,n),"yyyy-MM-dd")}Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints=function(n){this._viewModel=null;this._submittedSuccessDelegate=null;this._submittedFailedDelegate=null;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints.callBaseMethod(this,"initialize");this._submittedSuccessDelegate=Function.createDelegate(this,this.submitSuccess);this._submittedFailedDelegate=Function.createDelegate(this,this.submitFailed);var n=this,t=$(this.get_element()).kendoValidator().data("kendoValidator");this.set_viewModel(kendo.observable({Profile:this.get_viewModel(),IsAirmilesRequest:function(){var n=this.get("Profile.AirmilesRequest");return n===!0||n=="true"},ShowRemoveBooking:function(n){return n.data&&n.data.parent().length>1||n.parent&&n.parent().length>1},RerenderSelects:function(){$("select").trigger("render")},RemoveBooking:function(n){if(!(n.data.parent().length<=1)){var i=n.data.parent().indexOf(n.data),t=this.get("Profile.Items");t.splice(i,1);this.set("Profile.Items",t)}},RewardsTypeOptions:[{key:"false",value:"Points"},{key:"true",value:"Airmiles"}],AddBooking:function(){var n=this.get("Profile.Items");n.push(new BWRewards.BookingItem);this.set("Profile.Items",n)},Vendors:[],SendRequest:function(){if(this.Validator.validate()){this.set("Submitting",!0);this.set("Visible",!1);var t=this.get("Profile");BWRewards.SendMissingPoints(t.toJSON(),n._submittedSuccessDelegate,n._submittedFailedDelegate)}},Submitting:!1,Submitted:!1,SubmitError:!1,Visible:!0}));this.get_viewModel().Validator=t;kendo.bind(this.get_element(),this.get_viewModel());BWRewards.GetVendors(function(t){t.unshift({Key:"",Value:"Choose airline"});n.get_viewModel().set("Vendors",t)});$("select").not(".hasCustomSelect").customSelect()},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints.callBaseMethod(this,"dispose")},submitSuccess:function(){this.get_viewModel().set("Submitting",!1);this.get_viewModel().set("Submitted",!0);this.get_viewModel().set("Visible",!1)},submitFailed:function(){this.get_viewModel().set("Visible",!0);this.get_viewModel().set("Submitting",!1);this.get_viewModel().set("Submitted",!1);this.get_viewModel().set("SubmitError",!0)},get_viewModel:function(){return this._viewModel},set_viewModel:function(n){this._viewModel=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsMissingPoints",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard=function(n){this._viewModel=null;this._submittedSuccessDelegate=null;this._submittedFailedDelegate=null;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard.callBaseMethod(this,"initialize");this._submittedSuccessDelegate=Function.createDelegate(this,this.submitSuccess);this._submittedFailedDelegate=Function.createDelegate(this,this.submitFailed);var n=this;this.set_viewModel(kendo.observable({RequestMode:!0,OrderMode:!1,OrderingMode:!1,OrderedMode:!1,OrderError:!1,RequestClicked:function(){this.set("RequestMode",!1);this.set("OrderMode",!0)},OrderClicked:function(){this.set("OrderMode",!1);this.set("OrderingMode",!0);BWRewards.RequestNewCard(n._submittedSuccessDelegate,n._submittedFailedDelegate)},CancelClicked:function(){this.set("OrderMode",!1);this.set("OrderingMode",!1);this.set("RequestMode",!0)}}));kendo.bind(this.get_element(),this.get_viewModel())},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard.callBaseMethod(this,"dispose")},submitSuccess:function(){var n=this.get_viewModel();n.set("OrderMode",!1);n.set("OrderingMode",!1);n.set("OrderedMode",!0)},submitFailed:function(){var n=this.get_viewModel();n.set("OrderMode",!1);n.set("OrderingMode",!1);n.set("OrderError",!0)},get_viewModel:function(){return this._viewModel},set_viewModel:function(n){this._viewModel=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsReplacementCard",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes=function(n){this._viewModel=null;this._showCurrentlyAvailableProducts=null;this._submittedSuccessDelegate=null;this._submittedFailedDelegate=null;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes.callBaseMethod(this,"initialize");this._submittedSuccessDelegate=Function.createDelegate(this,this.submitSuccess);this._submittedFailedDelegate=Function.createDelegate(this,this.submitFailed);this.loadData()},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes.callBaseMethod(this,"dispose")},submitSuccess:function(n){this.set_viewModel(n);kendo.bind(this.get_element(),this.get_viewModel())},submitFailed:function(n,t){kendo.bind(this.get_element(),t)},loadData:function(){BWRewards.Prizes(this.get_showCurrentlyAvailableProducts(),this._submittedSuccessDelegate,this._submittedFailedDelegate)},get_showCurrentlyAvailableProducts:function(){return this._showCurrentlyAvailableProducts},set_showCurrentlyAvailableProducts:function(n){this._showCurrentlyAvailableProducts=n},get_viewModel:function(){return this._viewModel},set_viewModel:function(n){this._viewModel=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsBalanceAndPrizes",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.initializeBase(this,[n]);this._saveButton=null;this._saveDelegate=null;this._title=null;this._firstName=null;this._middleName=null;this._lastName=null;this._email=null;this._password=null;this._addressType=null;this._houseNumberName=null;this._street=null;this._locality=null;this._townCity=null;this._county=null;this._postcode=null;this._company=null;this._jobTitle=null;this._telephone=null;this._dateOfBirth=null;this._contactPreferencesId=null;this._earningPreference=null;this._airlineMilesVendor=null;this._airlineMilesNumber=null;this._confirmed18=null;this._successMessage=null;this._errorMessage=null;this._joinRewardsSuccessMessage=null;this._promotionCode=null;this._promotionId=null;this._promotionVendorCode=null;this._successPage=null;this._programCode=null;this._joinRewardsSuccessDelegate=null;this._joinRewardsErrorDelegate=null;this._joinRewardsCompleteDelegate=null;this._addressLookupConfig=null;this._isExpanded=null};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.callBaseMethod(this,"initialize");var n=this,t=this.get_element();this._saveDelegate=Function.createDelegate(this,this.save);$addHandler(this.get_saveButton(),"click",this._saveDelegate);this._joinRewardsSuccessDelegate=Function.createDelegate(this,this.joinRewardsSuccess);this._joinRewardsErrorDelegate=Function.createDelegate(this,this.joinRewardsError);this._joinRewardsCompleteDelegate=Function.createDelegate(this,this.joinRewardsComplete);$(".date_fld",t).bsDatepicker({format:"dd M yyyy",endDate:"-18y",startView:"decade",autoclose:!0});$('.rewardsAddress input[type="radio"]',t).on("change",function(){$(this).attr("value")!==undefined&&n.changeAddressType($(this).attr("value"))});$('.earningPreference input[type="radio"]').on("change",function(){$(this).attr("value")!==undefined&&n.changeEarningPreference($(this).attr("value"))})},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.callBaseMethod(this,"dispose")},save:function(){var n,i,t;return this.get_errorMessage().hide(),this.get_successMessage().hide(),Page_ClientValidate("joinRewards"),Page_IsValid&&($(".form_error").removeClass("form_error"),n=new BWRewards.JoinProfile,n.Title=$(this.get_title()).val(),n.FirstName=$(this.get_firstName()).val(),n.MiddleName=$(this.get_middleName()).val(),n.LastName=$(this.get_lastName()).val(),n.Email=n.Email=$(this.get_email()).val(),n.Password=$(this.get_password()).val(),n.AddressType=$('input[type="radio"]:checked',this.get_addressType()).val(),n.HouseNameNumber=$(this.get_houseNumberName()).val(),n.Street=$(this.get_street()).val(),n.Locality=$(this.get_locality()).val(),n.TownCity=$(this.get_townCity()).val(),n.County=$(this.get_county()).val(),n.Postcode=$(this.get_postcode()).val(),n.Company=$(this.get_company()).val(),n.JobTitle=$(this.get_jobTitle()).val(),n.Telephone=$(this.get_telephone()).val(),n.DateOfBirth=new Date($(this.get_dateOfBirth()).val()),i=document.getElementById(this.get_contactPreferencesId()),t=$("input:checked",i).val(),t&&(n.ContactPreferences=t==="true"),n.EarningPreference=$('input[type="radio"]:checked',this.get_earningPreference()).val(),n.AirmilesVendor=$("option:checked",this.get_airlineMilesVendor()).val(),n.AirmilesNumber=$(this.get_airlineMilesNumber()).val(),n.Confirmed18=$(this.get_confirmed18()).is(":checked"),n.AgentName=BestWestern.AgentName(),n.ProgramCode=this.get_programCode(),$(this.get_saveButton()).addClass("is_loading"),BWRewards.JoinRewards(n,this._joinRewardsSuccessDelegate,this._joinRewardsErrorDelegate)),!1},joinRewardsSuccess:function(n){this.get_promotionCode()&&this.get_promotionVendorCode?BWRewards.RegisterForPromotion(this.get_promotionCode(),this.get_promotionId(),n.MembershipNumber,this.get_promotionVendorCode(),this._joinRewardsCompleteDelegate,this._joinRewardsErrorDelegate):this.joinRewardsComplete()},joinRewardsError:function(n){$(this.get_saveButton()).removeClass("is_loading");this.get_successMessage().hide();this.get_errorMessage().showNegativeMessage(BWRewards.GetErrorMessage(n))},joinRewardsComplete:function(){$(this.get_saveButton()).removeClass("is_loading");window.location=this.get_successPage()},changeAddressType:function(n){n!==undefined&&n!==null&&n!==""&&($("[data-address-block]").hide(),$('[data-address-block="add_type_'+n.toLowerCase()+'"]').fadeIn())},changeEarningPreference:function(n){n!==undefined&&n!==null&&n!==""&&(n==="AIRLINEMILES"?$(".earning_pref_am").fadeIn():$(".earning_pref_am").hide())},initAddressLookups:function(){var n=this;setTimeout(function(){$("#homePostCode").each(function(t,i){var r=new BestWestern.AddressLookup(n.get_addressLookupConfig().FindUrl,n.get_addressLookupConfig().RetrieveUrl,i);$(i).kendoAutoComplete({dataSource:r.DataSource,select:function(t){n.addressSelection(t,n)},change:function(t){n.manualPostcodeUpdate(t,n)},minLength:3,animation:!1,dataTextField:"Text",template:kendo.template($("#addressLookupTemplate").html())});r.onFindFailure=function(t){n.addressLookupFailure(t,n)};$(i).attr("autocomplete","_off");$(i).data("BwAddressLookup",r)})},200)},addressLookupFailure:function(n,t){var i=t.getAddressModel(n);this.expandAddress()},getAddressModel:function(){return{HouseNumberName:"",StreetAddress:"",Locality:"",TownCity:"",Postcode:$("#homePostCode")[0].value}},manualPostcodeUpdate:function(n,t){var i=t.getAddressModel(n.sender.element)},addressSelection:function(n){var e=this,t=$("span.addressId",n.item).text(),i=$(n.sender.element).data("kendoAutoComplete"),r=function(n){n!=null&&($("#homeLine1")[0].value=n.houseNumberOrName,$("#homeLine2")[0].value=n.addressLine1,$("#homeLine3")[0].value=n.addressLine2,$("#homeTownCity")[0].value=n.townCity,$("#homePostCode")[0].value=n.postCode)},u=$(n.sender.element).data("BwAddressLookup"),f=u.HandleSelection(i,t,r);f&&this.expandAddress();n.preventDefault()},expandAddress:function(){$("#AddressManual").hide();$("#AddressDetails").show()},get_saveButton:function(){return this._saveButton},set_saveButton:function(n){this._saveButton=n},get_title:function(){return this._title},set_title:function(n){this._title=n},get_firstName:function(){return this._firstName},set_firstName:function(n){this._firstName=n},get_middleName:function(){return this._middleName},set_middleName:function(n){this._middleName=n},get_lastName:function(){return this._lastName},set_lastName:function(n){this._lastName=n},get_email:function(){return this._email},set_email:function(n){this._email=n},get_password:function(){return this._password},set_password:function(n){this._password=n},get_addressType:function(){return this._addressType},set_addressType:function(n){this._addressType=n},get_houseNumberName:function(){return this._houseNumberName},set_houseNumberName:function(n){this._houseNumberName=n},get_street:function(){return this._street},set_street:function(n){this._street=n},get_locality:function(){return this._locality},set_locality:function(n){this._locality=n},get_townCity:function(){return this._townCity},set_townCity:function(n){this._townCity=n},get_county:function(){return this._county},set_county:function(n){this._county=n},get_postcode:function(){return this._postcode},set_postcode:function(n){this._postcode=n},get_company:function(){return this._company},set_company:function(n){this._company=n},get_jobTitle:function(){return this._jobTitle},set_jobTitle:function(n){this._jobTitle=n},get_telephone:function(){return this._telephone},set_telephone:function(n){this._telephone=n},get_dateOfBirth:function(){return this._dateOfBirth},set_dateOfBirth:function(n){this._dateOfBirth=n},get_contactPreferencesId:function(){return this._contactPreferencesId},set_contactPreferencesId:function(n){this._contactPreferencesId=n},get_earningPreference:function(){return this._earningPreference},set_earningPreference:function(n){this._earningPreference=n},get_airlineMilesVendor:function(){return this._airlineMilesVendor},set_airlineMilesVendor:function(n){this._airlineMilesVendor=n},get_airlineMilesNumber:function(){return this._airlineMilesNumber},set_airlineMilesNumber:function(n){this._airlineMilesNumber=n},get_confirmed18:function(){return this._confirmed18},set_confirmed18:function(n){this._confirmed18=n},get_successMessage:function(){return this._successMessage},set_successMessage:function(n){this._successMessage=n},get_errorMessage:function(){return this._errorMessage},set_errorMessage:function(n){this._errorMessage=n},get_joinRewardsSuccessMessage:function(){return this._joinRewardsSuccessMessage},set_joinRewardsSuccessMessage:function(n){this._joinRewardsSuccessMessage=n},get_promotionCode:function(){return this._promotionCode},set_promotionCode:function(n){this._promotionCode=n},get_promotionId:function(){return this._promotionId},set_promotionId:function(n){this._promotionId=n},get_promotionVendorCode:function(){return this._promotionVendorCode},set_promotionVendorCode:function(n){this._promotionVendorCode=n},get_successPage:function(){return this._successPage},set_successPage:function(n){this._successPage=n},get_programCode:function(){return this._programCode},set_programCode:function(n){this._programCode=n},get_addressLookupConfig:function(){return this._addressLookupConfig},set_addressLookupConfig:function(n){this._addressLookupConfig=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards",Sys.UI.Control);Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.Over18_ClientValidate=function(n,t){t.IsValid=$('.confirm_18 input[type="checkbox"]').is(":checked")};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.Password_ClientValidate=function(n,t){if(!(t.Value!==null)){t.IsValid=!1;return}if(t.IsValid=t.Value.length>=10&&t.Value.length<=80&&!t.Value.startsWith(" ")&&!t.Value.endsWith(" "),t.IsValid){if(t.Value.length>=25){t.IsValid=!0;return}t.IsValid=t.Value.match("[A-Za-z]")!=null&&t.Value.match("[0-9]")!=null&&t.Value.match("[^a-zA-Z0-9]")!==null;return}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.AirlineMilesNumber_ClientValidate=function(n,t){t.IsValid=!$('input[value="AIRLINEMILES"]').is(":checked")||t.Value!==null&&t.Value.length>0};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.DateOfBirth_ClientValidate=function(n,t){var i,r,u;if(t.Value===null||t.Value===""){t.IsValid=!0;return}i=new Date(t.Value);r=Object.prototype.toString.call(i)==="[object Date]"&&!isNaN(i.getTime());r&&(u=new Date(i.getFullYear()+18,i.getMonth(),i.getDate()),r=u<=new Date);t.IsValid=r};var validateDate=!1;dateofbirthvalidate=function(){validateDate=!0;window.ValidatorValidate(window.dateOfBirthValidator);validateDate=!1};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.JoinRewards.DateOfBirth_ClientValidateMobile=function(n,t){var f=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,i,r,u;if(f==!1&&(validateDate=!0),validateDate){if(t.Value===null||t.Value===""){t.IsValid=!0;return}i=new Date(t.Value);r=Object.prototype.toString.call(i)==="[object Date]"&&!isNaN(i.getTime());r&&(u=new Date(i.getFullYear()+18,i.getMonth(),i.getDate()),r=u<=new Date);t.IsValid=r}};
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts=function(n){this._viewModel=null;Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts.initializeBase(this,[n])};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts.callBaseMethod(this,"initialize");this.loadData()},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts.callBaseMethod(this,"dispose")},loadData:function(){this.set_viewModel(new BWRewards.LinkAccountsViewModel);kendo.bind(this.get_element(),this.get_viewModel())},get_viewModel:function(){return this._viewModel},set_viewModel:function(n){this._viewModel=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.LinkAccounts",Sys.UI.Control);
Type.registerNamespace("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards");Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions=function(n){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions.initializeBase(this,[n]);this._promotionCode=null;this._promotionId=null;this._promotionSignUpButton=null;this._successMessage=null;this._successPage=null;this._rewardsIdInput=null;this._vendorCode=null;this._signUpSuccessDelegate=null;this._signUpSuccessFailed=null;this._signUpClickedDelegate=null};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions.prototype={initialize:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions.callBaseMethod(this,"initialize");this._signUpClickedDelegate=Function.createDelegate(this,this.signUpClicked);$addHandler(this.get_promotionSignUpButton(),"click",this._signUpClickedDelegate);this._signUpSuccessDelegate=Function.createDelegate(this,this.signUpSuccess);this._signUpFailedDelegate=Function.createDelegate(this,this.signUpFailed)},dispose:function(){Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions.callBaseMethod(this,"dispose")},signUpClicked:function(){var n=null;this.get_rewardsIdInput()&&(n=$(this.get_rewardsIdInput()).val());BWRewards.RegisterForPromotion(this.get_promotionCode(),this.get_promotionId(),n,this.get_vendorCode(),this._signUpSuccessDelegate,this._signUpFailedDelegate)},signUpSuccess:function(){$('[data-control="promotion-register"]',this.get_element()).hide();$('[data-control="promotion-register-success"]',this.get_element()).show()},signUpFailed:function(n){var t=JSON.parse(n.responseText),i=t&&t.ResponseStatus?t.ResponseStatus.Message:null;i?BestWestern.ShowMessage(i):BestWestern.ShowMessage("Failed to register")},get_promotionCode:function(){return this._promotionCode},set_promotionCode:function(n){this._promotionCode=n},get_promotionSignUpButton:function(){return this._promotionSignUpButton},set_promotionSignUpButton:function(n){this._promotionSignUpButton=n},get_rewardsIdInput:function(){return this._rewardsIdInput},set_rewardsIdInput:function(n){this._rewardsIdInput=n},get_vendorCode:function(){return this._vendorCode},set_vendorCode:function(n){this._vendorCode=n},get_successMessage:function(){return this._successMessage},set_successMessage:function(n){this._successMessage=n},get_successPage:function(){return this._successPage},set_successPage:function(n){this._successPage=n},get_promotionId:function(){return this._promotionId},set_promotionId:function(n){this._promotionId=n}};Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions.registerClass("Spinbox.Clients.BestWestern.Frontend.Web.UI.Rewards.RewardsPromotions",Sys.UI.Control);
function myshowp(n){txtBox=n.parentElement.getElementsByTagName("input").item(0);txtBox.type=="password"?(txtBox.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash")):(txtBox.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye"))};